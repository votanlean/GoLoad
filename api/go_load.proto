syntax = "proto3";

package go_load;

option go_package = "grpc/go_load";

service GoLoadService {
  rpc CreateAccount(CreateAccountRequest) returns (CreateAccountResponse) {}
  rpc CreateSession(CreateSessionRequest) returns (CreateSessionResponse) {}
  rpc CreateDownloadTask(CreateDownloadTaskRequest) returns (CreateDownloadTaskResponse) {}
  rpc GetDownloadTask(GetDownloadTaskListRequest) returns (GetDownloadTaskListResponse) {}
  rpc UpdateDownloadTask(UpdateDownloadTaskRequest) returns (UpdateDownloadTaskResponse) {}
  rpc DeleteDownloadTask(DeleteDownloadTaskRequest) returns (DeleteDownloadTaskResponse) {}
  rpc GetDownloadTaskFile(GetDownloadTaskFileRequest) returns (stream GetDownloadTaskFileResponse) {}
}

enum DownloadType {
  UndefinedType = 0;
  HTTP = 1;
}

enum DownloadStatus {
  UndefinedStatus = 0;
  Pending = 1;
  Downloading = 2;
  Failed = 3;
  Success = 4;
}

message User {
  uint64 id = 1;
  string username = 2;
}
message DownloadTask {
  uint64 id = 1;
  DownloadType type = 2;
  string url = 3;
  DownloadStatus status = 5;
}

message CreateAccountRequest {
  string username = 1;
  string password = 2;
}

message CreateAccountResponse {
  string username = 1;
}

message CreateSessionRequest {
  string username = 1;
  string password = 2;
}

message CreateSessionResponse {
  string token = 1;
}

message CreateDownloadTaskRequest {
  string token = 1;
  DownloadType type = 2;
  string url = 3;
  string filename = 4;
}

message CreateDownloadTaskResponse {}

message GetDownloadTaskListRequest {
  string token = 1;
  uint64 limit = 2;
  uint64 offset = 3;
}

message GetDownloadTaskListResponse {
  repeated DownloadTask download_task_list = 1;
  uint64 total_download_task_count = 2;

}

message UpdateDownloadTaskRequest {
  string token = 1;
  uint64 download_task_id = 2;
  string url = 3;
}

message UpdateDownloadTaskResponse {}

message DeleteDownloadTaskRequest {
  string token = 1;
  uint64 download_task_id = 2;
}

message DeleteDownloadTaskResponse {
}

message GetDownloadTaskFileRequest {
  string token = 1;
  uint64 download_task_id = 2;
}

message GetDownloadTaskFileResponse {
  bytes data = 1;
}